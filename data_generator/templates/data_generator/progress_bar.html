{% if progress %}
    <div class="d-flex justify-content-between align-items-center mb-2">
        <span class="text-muted">{{ progress.message }}</span>
        <span class="text-muted">{{ progress.progress_percentage }}%</span>
    </div>
    <div class="progress" style="height: 25px;">
        <div class="progress-bar progress-bar-striped progress-bar-animated 
                    {% if progress.progress_percentage < 30 %}bg-info
                    {% elif progress.progress_percentage < 70 %}bg-warning
                    {% else %}bg-success{% endif %}" 
             role="progressbar" 
             style="width: {{ progress.progress_percentage }}%" 
             aria-valuenow="{{ progress.progress_percentage }}" 
             aria-valuemin="0" 
             aria-valuemax="100">
        </div>
    </div>
    <div class="mt-2 text-center">
        <small class="text-muted">
            <i class="fas fa-spinner fa-spin"></i>
            {{ progress.current_step|title }}...
        </small>
    </div>
    
    {% if export.status == 'completed' %}
        <div class="mt-3 text-center">
            <a href="{% url 'download_excel' export.id %}" class="btn btn-success">
                <i class="fas fa-download"></i> Download Excel File
            </a>
        </div>
    {% elif export.status == 'failed' %}
        <div class="mt-3 text-center">
            <div class="alert alert-danger">
                <i class="fas fa-exclamation-triangle"></i>
                Generation failed: {{ export.error_message }}
            </div>
        </div>
    {% endif %}
{% else %}
    <div class="text-center text-muted">
        <i class="fas fa-spinner fa-spin"></i>
        Initializing...
    </div>
{% endif %}
